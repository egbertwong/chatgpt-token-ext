  console.error
    [DeepSeekTokenizer] Failed to load tokenizer: TypeError: Cannot read properties of undefined (reading 'json')
        at fromPreTrained (D:\codes\garage\chatgpt-token-ext\src\tokenizers\deepseek\index.ts:21:59)
        at Object.<anonymous> (D:\codes\garage\chatgpt-token-ext\__tests__\tokenizers\deepseek.test.ts:73:32)

    [0m [90m 30 |[39m         [36mreturn[39m tokenizer[33m;[39m
     [90m 31 |[39m     } [36mcatch[39m (e) {
    [31m[1m>[22m[39m[90m 32 |[39m         console[33m.[39merror([32m"[DeepSeekTokenizer] Failed to load tokenizer:"[39m[33m,[39m e)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 33 |[39m         [36mthrow[39m e[33m;[39m
     [90m 34 |[39m     }
     [90m 35 |[39m }[0m

      at fromPreTrained (src/tokenizers/deepseek/index.ts:32:17)
      at Object.<anonymous> (__tests__/tokenizers/deepseek.test.ts:73:32)

FAIL __tests__/tokenizers/deepseek.test.ts
  DeepSeek Tokenizer
    fromPreTrained
      è„³ should load tokenizer from bundled files (4 ms)
      è„³ should cache tokenizer on subsequent calls (17 ms)
      éˆ­?should handle fetch errors (2 ms)
      éˆ­?should handle JSON parsing errors (3 ms)
      è„³ should use correct Chrome extension URLs (1 ms)
      éˆ­?should load both files in parallel (22 ms)

  éˆ¼?DeepSeek Tokenizer éˆ¥?fromPreTrained éˆ¥?should load tokenizer from bundled files

    expect(received).toBeDefined()

    Received: undefined

      55 |                 tokenizerConfig: mockTokenizerConfig,
      56 |             });
    > 57 |             expect(tokenizer).toBeDefined();
         |                               ^
      58 |         });
      59 |
      60 |         it('should cache tokenizer on subsequent calls', async () => {

      at Object.<anonymous> (__tests__/tokenizers/deepseek.test.ts:57:31)

  éˆ¼?DeepSeek Tokenizer éˆ¥?fromPreTrained éˆ¥?should cache tokenizer on subsequent calls

    TypeError: Cannot read properties of undefined (reading 'json')

      19 |         ]);
      20 |
    > 21 |         const tokenizerJSON = await tokenizerJSONResponse.json();
         |                                                           ^
      22 |         const tokenizerConfig = await tokenizerConfigResponse.json();
      23 |
      24 |         const tokenizer = TokenizerLoader.fromPreTrained({

      at fromPreTrained (src/tokenizers/deepseek/index.ts:21:59)
      at Object.<anonymous> (__tests__/tokenizers/deepseek.test.ts:73:32)

  éˆ¼?DeepSeek Tokenizer éˆ¥?fromPreTrained éˆ¥?should use correct Chrome extension URLs

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "chrome-extension://fake-id/src/tokenizers/deepseek/tokenizer.json"
    Received
           1: undefined
           2: undefined

    Number of calls: 2

      123 |             await fromPreTrained();
      124 |
    > 125 |             expect(global.fetch).toHaveBeenCalledWith(
          |                                  ^
      126 |                 'chrome-extension://fake-id/src/tokenizers/deepseek/tokenizer.json'
      127 |             );
      128 |             expect(global.fetch).toHaveBeenCalledWith(

      at Object.<anonymous> (__tests__/tokenizers/deepseek.test.ts:125:34)

Test Suites: 1 failed, 1 total
Tests:       3 failed, 3 passed, 6 total
Snapshots:   0 total
Time:        2.035 s
Ran all test suites matching /__tests__\\tokenizers\\deepseek.test.ts/i.
